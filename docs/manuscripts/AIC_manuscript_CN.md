# 心脏手术围术期ACEI/ARB管理的个体化治疗效应估计：因果森林分析

## 摘要

**背景：** 近期证据表明围术期继续使用肾素-血管紧张素系统抑制剂（RASi）可减少心脏手术后的严重不良事件，但群体平均治疗效应无法为个体患者的临床决策提供指导。本研究应用因果森林分析估计个体水平的治疗效应，并识别哪些患者从继续用药中获益最大。

**结果：** 在9,456例倾向性评分匹配的心脏手术患者（来自12,355例合格患者）中，因果森林估计的复合不良事件条件平均治疗效应（CATE）均值为+0.012（95% CI 0.002–0.022, p=0.020），并经Bootstrap验证确认（均值+0.013, 95% CI 0.004–0.022）和逆概率加权验证（OR 1.24, 95% CI 1.08–1.42）。CATE分布显示97.4%的患者估计值为正（即支持继续用药），范围从-0.021到+0.045（变异系数0.52）。虽然grf校准检验未检测到统计学显著的定性异质性（p=0.95），但CATE与年龄显著正相关（Spearman rho=0.21, p<10^-96），与eGFR显著负相关（rho=-0.14, p<10^-42），提示存在连续的剂量-反应关系。≥65岁患者的平均CATE为0.013，NNT=29；而<65岁患者为0.011，NNT=238（交互作用p<0.001）。识别出三个患者聚类：高获益组（60.4%，平均CATE 0.013，高血压、低糖尿病比例），中等获益组（34.2%，平均CATE 0.010，较高龄、合并糖尿病和高血压），以及较小的中等获益组（5.4%，平均CATE 0.011，较年轻、无高血压）。所有结果与传统logistic回归亚组估计的方向100%一致。

**结论：** 因果森林分析提供了超越群体平均效应的患者水平治疗效应估计，揭示了患者特征与治疗获益之间的连续关系。尽管几乎所有心脏手术患者均从ACEI/ARB继续用药中获益，但获益幅度存在有意义的差异——从年轻患者的微小获益（NNT>200）到老年患者的临床显著获益（NNT约29）。这些个体化估计可支持精准围术期决策。

**关键词：** 因果森林，异质性治疗效应，ACEI/ARB，心脏手术，个体化医疗，围术期管理，条件平均治疗效应

---

## 背景

心脏手术围术期血管紧张素转换酶抑制剂（ACEI）和血管紧张素受体拮抗剂（ARB）的管理一直是临床长期争论的焦点[1,2]。近期的大规模证据，包括采用AKI严重程度分层分析的多中心队列研究，已开始阐明平均治疗效应：围术期继续使用RASi似乎可降低重度AKI和死亡率，同时轻度增加推测为功能性的轻度AKI[3,4]。然而，这些以平均风险比或比值比表达的群体水平估计，无法回答临床医生在床旁面临的核心问题：*这个具体患者从继续用药中能获益多少？*

传统亚组分析通过在预设分类内（如年龄65岁以上或以下）估计治疗效应，可部分弥补这一不足，但其局限在于只能处理少量二分类变量，忽略了连续的剂量-反应关系[5]。此外，亚组边界的选择本质上是任意的，多重比较还会增加假阳性率[6]。

因果森林是一种专为异质性治疗效应估计设计的机器学习方法，是随机森林的扩展[7]。通过递归地划分协变量空间以最大化治疗效应异质性，因果森林为每位患者估计一个条件平均治疗效应（CATE）——一个关于基线特征的连续多维函数。与传统方法对每个亚组只产生一个数值不同，因果森林产生患者特异性的估计，捕捉治疗获益的完整光谱。

重要的是，这种方法解决了现有证据的一个关键局限。尽管既往研究已确定*平均*患者从RASi继续用药中获益[3,4]，但个体治疗效应的*分布*——有多大比例的患者获益大、获益小或获益可忽略——仍然未知。理解这一分布对精准医疗至关重要：如果几乎所有患者获益相似，则普遍继续用药策略即可；如果存在显著异质性，则基于患者特征的精准策略可能改善预后。

本研究将因果森林分析应用于心脏手术多中心队列，旨在：(1) 估计围术期ACEI/ARB继续vs停用的个体水平治疗效应；(2) 描述治疗效应异质性的分布和决定因素；(3) 比较因果森林与传统亚组分析的方法学一致性。

## 方法

### 研究设计和人群

本研究为回顾性队列研究，纳入中国人民解放军总医院系统两个三级心脏外科中心的连续成人心脏手术患者。研究获得医院伦理委员会批准（解放军总医院 S2021-305-01），因回顾性设计免除知情同意。报告遵循STROBE观察性研究报告指南。

纳入标准：(1) 年龄≥18岁；(2) 行择期或限期心脏手术；(3) 术前有ACEI/ARB用药记录。排除标准：(1) 急诊手术；(2) 暴露数据缺失；(3) 关键结局变量缺失。

### 暴露与结局

暴露定义为术前停用ACEI/ARB（W=1）vs继续使用（W=0）。主要结局为复合不良事件（30天死亡、KDIGO 3期AKI、ECMO、主动脉内球囊反搏IABP或新发透析中任一发生）。次要结局包括复合终点各组分和AKI 1-3期。

### 缺失数据处理

连续变量缺失值采用多重插补链式方程（MICE, m=5次插补，预测均值匹配法）。BMI由身高体重计算，异常值以队列中位数替代。分类变量缺失比例<0.5%，采用完全病例删除。

### 倾向性评分匹配

使用logistic回归基于21个协变量（人口学特征、合并症、实验室指标、用药、手术因素）估计倾向性评分。采用1:1最近邻匹配（卡钳值=0.1），不放回抽样。以标准化均值差（SMD<0.1）评估平衡性。

### 因果森林分析

使用R语言grf包[7]拟合因果森林，具体参数：
- **决策树**：2,000棵，采用诚实分裂（估计样本与分裂样本分离）
- **调参**：通过袋外（OOB）优化自动调整所有超参数
- **协变量**：15个变量（年龄、性别、中心、BMI、eGFR、5个合并症、4种药物、体外循环）
- **随机种子**：固定以确保可重复性

对每位患者 *i*，因果森林估计一个条件平均治疗效应 τ(x_i)，代表给定协变量 x_i 下停药与继续用药之间的结局概率差。CATE>0表示停药增加风险（即继续用药有保护作用）。

平均治疗效应（ATE）使用grf中实现的双稳健增强逆倾向加权估计量。治疗效应异质性通过grf校准检验正式检测，该检验评估森林估计的CATE在均值之外是否对真实治疗效应具有显著预测能力[8]。

对每个次要结局分别拟合独立的因果森林模型，使用相同的参数设定。

### 异质性特征描述

个体CATE分布通过描述性统计（均值、标准差、四分位距、极差、正值/负值比例）刻画。CATE与关键协变量（年龄、eGFR、BMI）的连续关系通过Spearman相关和LOESS平滑评估。采用k-means对标准化CATE和临床特征进行数据驱动的患者聚类，最佳聚类数通过轮廓分析（k=2至6）选择。

### 与传统方法的一致性

为评估方法学一致性，我们在11个预设亚组中比较因果森林的亚组特异性CATE均值与传统logistic回归估计值（比值比和风险差）。方向一致性定义为治疗效应符号一致。

### 敏感性分析

1. **逆概率加权（IPTW）**：稳定化权重，1/99百分位截断，三明治标准误。
2. **Bootstrap验证**：500次重采样，每次完整重新拟合因果森林。
3. **卡钳值敏感性**：分别以0.05、0.10、0.15、0.20重复匹配。
4. **E值**：量化解释观测关联所需的最小未测量混杂强度[9]。
5. **超参数敏感性**：在9种树数（1000/2000/4000）×最小节点大小（5/10/20）组合下重新拟合。
6. **亚组交互检验**：含7个临床变量交互项的logistic回归，FDR校正。

使用R 4.4.3完成分析，主要使用grf 2.3.2、MatchIt、WeightIt、EValue和mice包。

## 结果

### 研究人群

从12,400例筛查患者中，12,355例满足纳入标准。经多重插补和1:1倾向性评分匹配后，9,456例患者（4,728对）纳入分析（图1）。匹配后基线特征良好平衡（所有SMD<0.1；图2）。平均年龄59岁，66%为男性，复合不良事件发生率8.4%。

### 平均治疗效应：多方法一致

三种分析方法对主要复合结局产生了一致的估计（表1）：

| 方法 | 估计值 | 95% CI | p值 |
|------|--------|--------|-----|
| 因果森林ATE | +0.012 | 0.002至0.022 | 0.020 |
| PSM（OR） | 1.237 | 1.069至1.431 | 0.004 |
| IPTW（OR） | 1.237 | 1.078至1.419 | 0.001 |

Bootstrap验证确认了稳定性（均值ATE +0.013, 95% CI 0.004–0.022；偏差+0.001）。结果在所有卡钳宽度下一致（OR范围1.24–1.27，均p<0.005）。E值为1.78。

### 个体治疗效应分布

因果森林为全部9,456例患者估计了个体CATE（图3）。关键分布特征：

- **CATE均值**：0.012（SD 0.006）
- **范围**：-0.021至+0.045
- **97.4%的患者**CATE为正值（支持继续用药）
- **2.6%**CATE为负值（可能支持停药）
- **变异系数**：0.52，提示中等程度的相对异质性
- **四分位距**：0.008至0.016

grf校准检验确认了均值森林预测的显著性（p=0.010），表明CATE估计捕捉到了真实的治疗效应。然而，差异预测检验——评估超出均值的异质性是否统计学显著——不显著（p=0.95）。这表明继续用药的保护作用在几乎所有患者中方向一致，但在幅度上存在临床有意义但统计学上温和的变异。

### 治疗获益的连续决定因素

与强制任意二分类的传统亚组分析不同，因果森林CATE揭示了与基线特征的连续剂量-反应关系（图4）：

**年龄**（Spearman rho=0.213, p<10^-96）：治疗获益随年龄单调递增。LOESS平滑显示近线性正向关系，CATE从40岁时约0.008升高到80岁时约0.020——2.5倍的梯度。这转化为NNT从年轻患者的>200改善到老年患者（≥65岁）的约29。

**eGFR**（rho=-0.140, p<10^-42）：eGFR较低的患者从继续用药中获益更大。关系呈非线性，eGFR低于60 mL/min/1.73m²时CATE梯度更陡。eGFR<60的患者平均CATE为0.012（NNT=29），而eGFR≥90的患者为0.011（NNT=151）。

**BMI**（rho=0.113, p<10^-28）：较弱但显著的正相关，BMI越高治疗获益越大。

这些连续关系提供了二元亚组分析无法捕捉的精细度。例如，一位72岁、eGFR 55的患者和一位45岁、eGFR 105的患者在传统分析中都归入宽泛的"获益"类别，但他们的估计CATE相差约2倍（0.018 vs 0.009）。

### 患者聚类

轮廓分析确定k=3为最优（轮廓系数0.28）。三个聚类代表了临床上不同的患者画像（表2）：

| 聚类 | N（%） | 平均CATE | 年龄 | eGFR | 主要特征 |
|------|--------|----------|------|------|----------|
| 1（高获益） | 5,712（60%） | 0.013 | 58 | 90 | 高血压、低糖尿病 |
| 2（中等获益） | 3,231（34%） | 0.010 | 64 | 81 | 高血压+糖尿病 |
| 3（中等获益） | 513（5%） | 0.011 | 52 | 98 | 非高血压 |

所有聚类的平均CATE均为正值，强化了治疗效应方向的普遍性。聚类1和2之间1.3倍的平均CATE差异反映了年龄、eGFR和合并症负担的综合影响。

### 因果森林与传统估计的一致性

在11个预设亚组中，因果森林与传统logistic回归显示**100%的方向一致性**（表3）。在传统分析发现显著效应的所有亚组中，因果森林识别出更高的平均CATE；在传统估计不显著的亚组中，CATE较低但仍为正值。

这种一致性提供了相互验证：传统方法证实了因果森林识别的模式，而因果森林增加了传统方法所缺乏的连续、个体水平的精细度。

### 次要结局：多结局因果森林

对各个结局分别拟合的因果森林揭示了与既往文献一致的严重度依赖模式[3]（表4）：

| 结局 | ATE | 95% CI | p值 | 方向 |
|------|-----|--------|-----|------|
| 复合不良事件 | +0.012 | 0.002至0.022 | 0.020 | 停药有害 |
| 30天死亡 | +0.003 | -0.001至0.008 | 0.169 | 不显著 |
| AKI 1期 | -0.026 | -0.043至-0.010 | 0.001 | 停药有保护作用 |
| AKI 2期 | +0.002 | -0.008至0.011 | 0.714 | 不显著 |
| AKI 3期 | +0.003 | -0.004至0.010 | 0.369 | 不显著 |
| AKI 全部分期 | -0.024 | -0.041至-0.007 | 0.006 | 停药有保护作用 |

轻度AKI（停药有保护作用）与复合终点（停药有害）方向相反，与此前在更大规模五中心队列中使用传统方法报告的严重度依赖分离一致[3]，提供了独立的方法学确认。

## 讨论

### 从平均效应到个体估计

本研究将围术期ACEI/ARB管理的证据从群体水平平均值推进到患者水平估计。虽然既往研究已确定平均而言继续用药可减少严重不良事件[3,4]，但当患者的基线风险特征差异很大时，平均效应的临床实用性有限。我们的因果森林分析表明，个体治疗效应跨越了临床有意义的范围，从年轻健康患者的微小获益（CATE约0.008, NNT>200）到合并肾功能不全的老年患者的显著获益（CATE约0.020, NNT约29）。

年龄谱上2.5倍的CATE梯度和与eGFR的连续反向关系提供了传统二元亚组无法捕捉的信息。当临床医生需要决定是否对一位55岁、eGFR 75的患者继续ACEI/ARB时，平均治疗效应或二分类亚组分析提供的指导有限。相比之下，因果森林CATE将该患者定位在连续获益梯度上，实现更精细的风险-获益沟通。

### 异质性：定量而非定性

一项重要发现是grf差异异质性校准检验不显著（p=0.95），表明治疗效应在患者间不存在*定性*差异。几乎所有患者（97.4%）被估计从继续用药中获益，没有可识别的适合停药的亚组。这种"普遍但分级"的获益模式具有直接的临床意义：它支持对所有患者默认继续用药的策略，预期获益幅度随患者特征变化而非方向变化。

这一发现本身具有临床价值。与治疗效应异质性包含获益和受害亚组（需要谨慎患者选择）的情况不同，围术期ACEI/ARB继续用药似乎是一种"广泛获益"的干预，具有效应大小的梯度。这简化了临床决策，同时仍允许基于个体估计获益的知情共同决策。

### 方法学一致性作为验证

因果森林估计与传统logistic回归在11个亚组中100%的方向一致性提供了强有力的相互验证。这种一致性回应了临床研究中对机器学习方法的常见顾虑——它们可能识别出虚假模式。当数据驱动方法（因果森林）和理论驱动方法（预设亚组分析）得出相同结论时，两者的可信度都增强。

此外，三种不同分析方法（PSM、IPTW和因果森林）对平均治疗效应的一致性——点估计值在窄范围内（PSM和IPTW的OR 1.24；因果森林ATE +0.012）——强化了结果对模型设定选择的稳健性。

### 与既往证据的比较

我们的平均治疗效应估计与既往多中心证据一致，后者表明围术期RASi继续用药可减少严重不良事件[3,10,11]。次要AKI结局中的严重度依赖模式——轻度AKI因停药而减少、严重结局因停药而增加——此前已在更大规模五中心队列中使用传统方法独立报告[3]。因果森林方法提供了这一现象的互补性个体水平确认。

我们的因果森林分析中未检测到统计学显著的定性异质性，与既往亚组分析显示的有限效应修饰一致[3,12]。然而，我们识别出的连续剂量-反应关系（特别是单调的年龄-CATE梯度和非线性的eGFR-CATE关系）提供了超越二元亚组分析的新信息。

### 局限性

应当承认以下局限性。第一，尽管进行了多方法验证和敏感性分析（E值1.78），本观察性研究不能排除未测量混杂。第二，数据来自两个中国中心，限制了外推性。第三，19%患者的BMI为插补值，尽管敏感性分析稳健。第四，因果森林未检测到统计学显著的定性异质性；识别出的变异是定量的，代表普遍保护效应的梯度，限制了识别特异性适合停药患者的能力。第五，池化多重插补（平均m=5个数据集）与完整Rubin规则相比可能略微低估标准误。第六，个体水平估计需要在独立队列中进行外部验证后方可临床实施。

## 结论

因果森林分析揭示，心脏手术围术期ACEI/ARB继续用药的保护效应在方向上是普遍的，但在幅度上是分级的。个体治疗效应范围从年轻患者的微小获益到合并肾功能不全老年患者的临床显著获益，具有传统亚组分析无法捕捉的连续剂量-反应关系。这些患者水平的估计为精准围术期决策提供了框架，支持默认继续用药策略并进行个体化获益沟通。

## 声明

**伦理批准与知情同意：** 获中国人民解放军总医院伦理委员会批准（S2021-305-01）。因回顾性设计免除知情同意。

**发表同意：** 不适用。

**数据与材料可用性：** 数据可在合理要求下从通讯作者处获取。

**利益冲突：** 作者声明无利益冲突。

**基金资助：** [待补充]

**作者贡献：** [待补充]

**致谢：** [待补充]

## 参考文献

1. Hollmann C, Fernandes NL, Biccard BM. A systematic review of outcomes associated with withholding or continuing angiotensin-converting enzyme inhibitors and angiotensin receptor blockers before noncardiac surgery. Anesth Analg. 2018;127:678-687.
2. Legrand M, Futier E, Mebazaa A, et al. Continuation vs discontinuation of renin-angiotensin system inhibitors before major noncardiac surgery: the Stop-or-Not randomized clinical trial. JAMA. 2024;332:970-978.
3. Zhong Q, Li Z, Jiang Y, et al. Perioperative continuing vs. discontinuing RAS inhibitors on kidney outcomes and mortality in cardiac surgery: a target trial emulation using multicenter data. [已投稿/在审 Critical Care]. 2026.
4. Ding Q, Zhang Z, Liu H, et al. Perioperative use of renin-angiotensin system inhibitors and outcomes in patients undergoing cardiac surgery. Nat Commun. 2019;10:4202.
5. Kent DM, Steyerberg E, van Klaveren D. Personalized evidence-based medicine: predictive approaches to heterogeneous treatment effects. BMJ. 2018;363:k4245.
6. Brookes ST, Whitely E, Egger M, et al. Subgroup analyses in randomised trials: risks of subgroup-specific analyses; power and sample size for the interaction test. J Clin Epidemiol. 2004;57:229-236.
7. Athey S, Tibshirani J, Wager S. Generalized random forests. Ann Stat. 2019;47:1148-1178.
8. Chernozhukov V, Demirer M, Duflo E, Fernandez-Val I. Generic machine learning inference on heterogeneous treatment effects in randomized experiments. arXiv preprint arXiv:1712.04802. 2018.
9. VanderWeele TJ, Ding P. Sensitivity analysis in observational research: introducing the E-value. Ann Intern Med. 2017;167:268-274.
10. Drenger B, Fontes ML, Miao Y, et al. Patterns of use of perioperative angiotensin-converting enzyme inhibitors in coronary artery bypass graft surgery with cardiopulmonary bypass. Circulation. 2012;126:261-269.
11. Zhou H, Xie J, Zheng Z, et al. Effect of renin-angiotensin system inhibitors on acute kidney injury among patients undergoing cardiac surgery: a review and meta-analysis. Semin Thorac Cardiovasc Surg. 2021;33:1014-1022.
12. Roshanov PS, Rochwerg B, Patel A, et al. Withholding versus continuing angiotensin-converting enzyme inhibitors or angiotensin II receptor blockers before noncardiac surgery. Anesthesiology. 2017;126:16-27.

## 表格与图

**表1.** 主要复合结局的多方法治疗效应估计。

**表2.** 基于因果森林CATE聚类的患者画像。

**表3.** 因果森林与传统logistic回归亚组估计的一致性。

**表4.** 各结局的因果森林平均治疗效应。

**图1.** 患者流程图。

**图2.** 倾向性评分匹配后协变量平衡（Love plot）。

**图3.** 个体条件平均治疗效应（CATE）分布。

**图4.** 患者特征与治疗获益的连续关系：(A) 年龄 vs CATE，(B) eGFR vs CATE，LOESS平滑。

**图5.** 因果森林模型中的变量重要性。

**附表S1.** 缺失数据报告。

**附表S2.** 卡钳值敏感性分析。

**附表S3.** 超参数敏感性分析。

**附表S4.** FDR校正的亚组交互检验。

**附表S5.** AKI结局的竞争风险分析。

**附图S1.** 按治疗组的倾向性评分分布。

**附图S2.** Bootstrap ATE分布（500次重采样）。

**附图S3.** 校准图：按十分位数的预测vs观测CATE。
